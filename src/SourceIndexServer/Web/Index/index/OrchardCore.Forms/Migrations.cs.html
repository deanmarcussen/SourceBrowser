<!DOCTYPE html>
<html><head><title>Migrations.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(156);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.Forms/Migrations.cs" target="_top">Migrations.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.Forms" target="_top">src\OrchardCore.Modules\OrchardCore.Forms\OrchardCore.Forms.csproj</a> (OrchardCore.Forms)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ContentManagement</span>.<span class="i">Metadata</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ContentManagement</span>.<span class="i">Metadata</span>.<span class="i">Settings</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i">Data</span>.<span class="i">Migration</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">Forms</span>
{
    <b>public class</b> <a id="bce160240f17340a" href="R/bce160240f17340a.html" target="n" data-glyph="0,0" class="t t">Migrations</a> : <span class="i">DataMigration</span>
    {
        <b>private readonly</b> <span class="i">IContentDefinitionManager</span> <a id="a14cf34e21631d56" href="R/a14cf34e21631d56.html" target="n" data-glyph="46,1" class="i field">_contentDefinitionManager</a>;
 
        <b>public</b> <a id="07bca083f59479e7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">Migrations</a>(<span class="i">IContentDefinitionManager</span> <span id="r0 rd" class="r0 r">contentDefinitionManager</span>)
        {
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a> = <span class="r0 r">contentDefinitionManager</span>;
        }
 
        <b>public int</b> <a id="1df82cddfc368868" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Create</a>()
        {
            <span class="c">// Form</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;FormPart&quot;</span>, <span id="r1 rd" class="r1 r">part</span> =&gt; <span class="r1 r">part</span>
                .<span class="i">Attachable</span>()
                .<span class="i">WithDescription</span>(<span class="s">&quot;Turns your content item into a form.&quot;</span>));
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Form&quot;</span>, <span id="r2 rd" class="r2 r">type</span> =&gt; <span class="r2 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;TitlePart&quot;</span>, <span id="r3 rd" class="r3 r">part</span> =&gt; <span class="r3 r">part</span>
                    .<span class="i">WithSettings</span>(<b>new</b> <a href="#71aecdd34504f7f9" class="t constructor">TitlePartSettings</a> { <a href="#ee17326fe7600bca" class="i property">RenderTitle</a> = <b>false</b> })
                    .<span class="i">WithPosition</span>(<span class="s">&quot;0&quot;</span>)
                )
                .<span class="i">WithPart</span>(<span class="s">&quot;FormElementPart&quot;</span>, <span id="r4 rd" class="r4 r">part</span> =&gt;
                   <span class="r4 r">part</span>.<span class="i">WithPosition</span>(<span class="s">&quot;1&quot;</span>)
                )
                .<span class="i">WithPart</span>(<span class="s">&quot;FormPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;FlowPart&quot;</span>)
                .<span class="i">Stereotype</span>(<span class="s">&quot;Widget&quot;</span>));
 
            <span class="c">// FormElement</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;FormElementPart&quot;</span>, <span id="r5 rd" class="r5 r">part</span> =&gt; <span class="r5 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Provides attributes common to all form elements.&quot;</span>));
 
            <span class="c">// FormInputElement</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;FormInputElementPart&quot;</span>, <span id="r6 rd" class="r6 r">part</span> =&gt; <span class="r6 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Provides attributes common to all input form elements.&quot;</span>));
 
            <span class="c">// Label</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;LabelPart&quot;</span>, <span id="r7 rd" class="r7 r">part</span> =&gt; <span class="r7 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Provides label properties.&quot;</span>));
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Label&quot;</span>, <span id="r8 rd" class="r8 r">type</span> =&gt; <span class="r8 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;TitlePart&quot;</span>, <span id="r9 rd" class="r9 r">part</span> =&gt; <span class="r9 r">part</span>
                    .<span class="i">WithSettings</span>(<b>new</b> <a href="#71aecdd34504f7f9" class="t constructor">TitlePartSettings</a> { <a href="#ee17326fe7600bca" class="i property">RenderTitle</a> = <b>false</b> })
                )
                .<span class="i">WithPart</span>(<span class="s">&quot;FormElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;LabelPart&quot;</span>)
                .<span class="i">Stereotype</span>(<span class="s">&quot;Widget&quot;</span>));
 
            <span class="c">// Input</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;InputPart&quot;</span>, <span id="r10 rd" class="r10 r">part</span> =&gt; <span class="r10 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Provides input field properties.&quot;</span>));
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Input&quot;</span>, <span id="r11 rd" class="r11 r">type</span> =&gt; <span class="r11 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;FormInputElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;FormElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;InputPart&quot;</span>)
                .<span class="i">Stereotype</span>(<span class="s">&quot;Widget&quot;</span>));
 
            <span class="c">// TextArea</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;TextAreaPart&quot;</span>, <span id="r12 rd" class="r12 r">part</span> =&gt; <span class="r12 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Provides text area properties.&quot;</span>));
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;TextArea&quot;</span>, <span id="r13 rd" class="r13 r">type</span> =&gt; <span class="r13 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;FormInputElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;FormElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;TextAreaPart&quot;</span>)
                .<span class="i">Stereotype</span>(<span class="s">&quot;Widget&quot;</span>));
 
            <span class="c">// Select</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;SelectPart&quot;</span>, <span id="r14 rd" class="r14 r">part</span> =&gt; <span class="r14 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Provides select field properties.&quot;</span>));
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Select&quot;</span>, <span id="r15 rd" class="r15 r">type</span> =&gt; <span class="r15 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;FormInputElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;FormElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;SelectPart&quot;</span>)
                .<span class="i">Stereotype</span>(<span class="s">&quot;Widget&quot;</span>));
 
            <span class="c">// Button</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;ButtonPart&quot;</span>, <span id="r16 rd" class="r16 r">part</span> =&gt; <span class="r16 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Provides button properties.&quot;</span>));
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Button&quot;</span>, <span id="r17 rd" class="r17 r">type</span> =&gt; <span class="r17 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;FormInputElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;FormElementPart&quot;</span>)
                .<span class="i">WithPart</span>(<span class="s">&quot;ButtonPart&quot;</span>)
                .<span class="i">Stereotype</span>(<span class="s">&quot;Widget&quot;</span>));
 
            <span class="c">// Validation Summary</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;ValidationSummaryPart&quot;</span>, <span id="r18 rd" class="r18 r">part</span> =&gt; <span class="r18 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Displays a validation summary.&quot;</span>));
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;ValidationSummary&quot;</span>, <span id="r19 rd" class="r19 r">type</span> =&gt; <span class="r19 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;ValidationSummaryPart&quot;</span>)
                .<span class="i">Stereotype</span>(<span class="s">&quot;Widget&quot;</span>));
 
            <span class="c">// Validation</span>
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterPartDefinition</span>(<span class="s">&quot;ValidationPart&quot;</span>, <span id="r20 rd" class="r20 r">part</span> =&gt; <span class="r20 r">part</span>
                .<span class="i">WithDescription</span>(<span class="s">&quot;Displays a field validation error.&quot;</span>));
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Validation&quot;</span>, <span id="r21 rd" class="r21 r">type</span> =&gt; <span class="r21 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;ValidationPart&quot;</span>)
                .<span class="i">Stereotype</span>(<span class="s">&quot;Widget&quot;</span>));
 
            <span class="c">// Shortcut other migration steps on new content definition schemas.</span>
            <b>return</b> 3;
        }
 
        <span class="c">// This code can be removed in a later version.</span>
        <b>public int</b> <a id="94c954c2e0f319f2" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateFrom1</a>()
        {
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Form&quot;</span>, <span id="r22 rd" class="r22 r">type</span> =&gt; <span class="r22 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;TitlePart&quot;</span>, <span id="r23 rd" class="r23 r">part</span> =&gt; <span class="r23 r">part</span>.<span class="i">MergeSettings</span>&lt;<a href="#71aecdd34504f7f9" class="t t">TitlePartSettings</a>&gt;(<span id="r24 rd" class="r24 r">setting</span> =&gt; <span class="r24 r">setting</span>.<span class="i">RenderTitle</span> = <b>false</b>))
            );
 
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Label&quot;</span>, <span id="r25 rd" class="r25 r">type</span> =&gt; <span class="r25 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;TitlePart&quot;</span>, <span id="r26 rd" class="r26 r">part</span> =&gt; <span class="r26 r">part</span>.<span class="i">MergeSettings</span>&lt;<a href="#71aecdd34504f7f9" class="t t">TitlePartSettings</a>&gt;(<span id="r27 rd" class="r27 r">setting</span> =&gt; <span class="r27 r">setting</span>.<span class="i">RenderTitle</span> = <b>false</b>))
            );
 
            <b>return</b> 2;
        }
 
        <span class="c">// This code can be removed in a later version.</span>
        <b>public int</b> <a id="ff33ef6d111f8de8" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateFrom2</a>()
        {
            <a href="#a14cf34e21631d56" class="i field">_contentDefinitionManager</a>.<span class="i">AlterTypeDefinition</span>(<span class="s">&quot;Form&quot;</span>, <span id="r28 rd" class="r28 r">type</span> =&gt; <span class="r28 r">type</span>
                .<span class="i">WithPart</span>(<span class="s">&quot;TitlePart&quot;</span>, <span id="r29 rd" class="r29 r">part</span> =&gt; <span class="r29 r">part</span>
                    .<span class="i">WithPosition</span>(<span class="s">&quot;0&quot;</span>)
                )
                .<span class="i">WithPart</span>(<span class="s">&quot;FormElementPart&quot;</span>, <span id="r30 rd" class="r30 r">part</span> =&gt;
                   <span class="r30 r">part</span>.<span class="i">WithPosition</span>(<span class="s">&quot;1&quot;</span>)
                )
            );
 
            <b>return</b> 3;
        }
 
        <b>internal class</b> <a id="71aecdd34504f7f9" href="R/71aecdd34504f7f9.html" target="n" data-glyph="2,1" class="t t"><span id="695bd48e4633f97b">TitlePartSettings</span></a>
        {
            <b>public int</b> <a id="7907294098adbdde" href="R/../../0000000000.html" target="n" data-glyph="102,2" class="i property">Options</a> { <b>get</b>; <b>set</b>; }
 
            <b>public string</b> <a id="722abfddaee11cca" href="R/../../0000000000.html" target="n" data-glyph="102,2" class="i property">Pattern</a> { <b>get</b>; <b>set</b>; }
 
            [<a href="@1@System.Runtime/A.html#2b44d242196c47b3" class="t constructor">DefaultValue</a>(<b>true</b>)]
            <b>public bool</b> <a id="ee17326fe7600bca" href="R/ee17326fe7600bca.html" target="n" data-glyph="102,2" class="i property">RenderTitle</a> { <b>get</b>; <b>set</b>; }
        }
    }
}
</pre></td></tr></table></div></body></html>
