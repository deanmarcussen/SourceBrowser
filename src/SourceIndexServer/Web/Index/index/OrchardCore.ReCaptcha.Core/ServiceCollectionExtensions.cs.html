<!DOCTYPE html>
<html><head><title>ServiceCollectionExtensions.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(33);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.ReCaptcha.Core/ServiceCollectionExtensions.cs" target="_top">ServiceCollectionExtensions.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.ReCaptcha.Core" target="_top">src\OrchardCore\OrchardCore.ReCaptcha.Core\OrchardCore.ReCaptcha.Core.csproj</a> (OrchardCore.ReCaptcha.Core)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">DependencyInjection</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">Options</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ReCaptcha</span>.<span class="i n">ActionFilters</span>.<span class="i n">Detection</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ReCaptcha</span>.<span class="i n">Configuration</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ReCaptcha</span>.<span class="i n">Services</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ReCaptcha</span>.<span class="i n">TagHelpers</span>;
<b>using</b> <span class="i">Polly</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">ReCaptcha</span>.<span class="i n">Core</span>
{
    <b>public static class</b> <a id="49cf4d31deefb4f7" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">ServiceCollectionExtensions</a>
    {
        <b>public static</b> <span class="t t">IServiceCollection</span> <a id="2262bf07feffe450" href="R/2262bf07feffe450.html" target="n" data-glyph="220,1" class="i method">AddReCaptcha</a>(<b>this</b> <span class="t t">IServiceCollection</span> <span id="r0 rd" class="r0 r">services</span>, <a href="@1@System.Runtime/A.html#486d58da4553e12d" class="t t">Action</a>&lt;<a href="Configuration/ReCaptchaSettings.cs.html#12de092abc7bfa45" class="t t">ReCaptchaSettings</a>&gt; <span id="r1 rd" class="r1 r">configure</span> = <b>null</b>)
        {
            <span class="r0 r">services</span>.<span class="i method">AddHttpClient</span>&lt;<a href="Services/ReCaptchaClient.cs.html#de259509c3eb8475" class="t t">ReCaptchaClient</a>&gt;()
                .<span class="i">AddTransientHttpErrorPolicy</span>(<span id="r2 rd" class="r2 r">policy</span> =&gt; <span class="r2 r">policy</span>.<span class="i">WaitAndRetryAsync</span>(3, <span id="r3 rd" class="r3 r">attempt</span> =&gt; <a href="@1@System.Runtime/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<span class="i">FromSeconds</span>(0.5 * <span class="r3 r">attempt</span>)));
 
            <span class="r0 r">services</span>.<span class="i method">AddTransient</span>&lt;<a href="ActionFilters/Detection/IDetectRobots.cs.html#08a0989845b789c2" class="t t">IDetectRobots</a>, <a href="ActionFilters/Detection/IpAddressRobotDetector.cs.html#d49c70dbbb0fb71d" class="t t">IpAddressRobotDetector</a>&gt;();
            <span class="r0 r">services</span>.<span class="i method">AddTransient</span>&lt;<span class="t t">IConfigureOptions</span>&lt;<a href="Configuration/ReCaptchaSettings.cs.html#12de092abc7bfa45" class="t t">ReCaptchaSettings</a>&gt;, <a href="Configuration/ReCaptchaSettingsConfiguration.cs.html#48321f3312c576de" class="t t">ReCaptchaSettingsConfiguration</a>&gt;();
            <span class="r0 r">services</span>.<span class="i method">AddTransient</span>&lt;<a href="Services/ReCaptchaService.cs.html#6e6357c3634e7533" class="t t">ReCaptchaService</a>&gt;();
            <span class="r0 r">services</span>.<a href="/OrchardCore.DisplayManagement/A.html#60e5baa06806c507" class="i method">AddTagHelpers</a>&lt;<a href="TagHelpers/ReCaptchaTagHelper.cs.html#58e4618dabbeae98" class="t t">ReCaptchaTagHelper</a>&gt;();
 
            <b>if</b> (<span class="r1 r">configure</span> != <b>null</b>)
            {
                <span class="r0 r">services</span>.<span class="i method">Configure</span>(<span class="r1 r">configure</span>);
            }
 
            <b>return</b> <span class="r0 r">services</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
