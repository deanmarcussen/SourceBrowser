<!DOCTYPE html>
<html><head><title>UpdatableDataProvider.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(68);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.Abstractions/Shell/Configuration/Internal/UpdatableDataProvider.cs" target="_top">Shell\Configuration\Internal\UpdatableDataProvider.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.Abstractions" target="_top">src\OrchardCore\OrchardCore.Abstractions\OrchardCore.Abstractions.csproj</a> (OrchardCore.Abstractions)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">Configuration</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">Primitives</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">Environment</span>.<span class="i n">Shell</span>.<span class="i n">Configuration</span>.<span class="i n">Internal</span>
{
    <b>internal class</b> <a id="31d22fddddb09f06" href="../../../R/31d22fddddb09f06.html" target="n" data-glyph="2,0" class="t t">UpdatableDataProvider</a> : <span class="t t">IConfigurationProvider</span>, <a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@1@System.Runtime/A.html#8585965bb176a426" class="t t">KeyValuePair</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt;&gt;
    {
        <b>private</b> <span class="t t">ConfigurationReloadToken</span> <a id="49906eb23a464a03" href="../../../R/49906eb23a464a03.html" target="n" data-glyph="46,1" class="i field">_reloadToken</a> = <b>new</b> <span class="t constructor">ConfigurationReloadToken</span>();
 
        <b>public</b> <a id="7e3c1d7e27e8cb0f" href="../../../R/7e3c1d7e27e8cb0f.html" target="n" data-glyph="72,1" class="t constructor">UpdatableDataProvider</a>(<a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@1@System.Runtime/A.html#8585965bb176a426" class="t t">KeyValuePair</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt;&gt; <span id="r0 rd" class="r0 r">initialData</span>)
        {
            <a href="#daa14005712a8bf5" class="i property">Data</a> = <b>new</b> <span class="t constructor">ConcurrentDictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt;(<span class="r0 r">initialData</span>, <a href="@1@System.Runtime/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@1@System.Runtime/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>);
        }
 
        <b>protected</b> <a href="@1@System.Runtime/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="daa14005712a8bf5" href="../../../R/daa14005712a8bf5.html" target="n" data-glyph="105,1" class="i property">Data</a> { <b>get</b>; <b>set</b>; }
 
        <b>public void</b> <a id="f87008ae1a023514" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">key</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r2 rd" class="r2 r">value</span>) =&gt; <a href="#daa14005712a8bf5" class="i property">Data</a>.<a href="@1@System.Runtime/A.html#380bc69e46a83183" class="i method">Add</a>(<span class="r1 r">key</span>, <span class="r2 r">value</span>);
 
        <b>public</b> <a href="@1@System.Runtime/A.html#893e8cdebffde2da" class="t t">IEnumerator</a>&lt;<a href="@1@System.Runtime/A.html#8585965bb176a426" class="t t">KeyValuePair</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt;&gt; <a id="994152c5aac791d0" href="../../../R/994152c5aac791d0.html" target="n" data-glyph="72,1" class="i method">GetEnumerator</a>() =&gt; <a href="#daa14005712a8bf5" class="i property">Data</a>.<a href="@1@System.Runtime/A.html#a242475701b655b2" class="i method">GetEnumerator</a>();
 
        <a href="@1@System.Runtime/A.html#6624f38cb955bfe0" class="t t">IEnumerator</a> <a href="@1@System.Runtime/A.html#9be451ac13d86a97" class="t t">IEnumerable</a>.<a href="@1@System.Runtime/A.html#02a44b09e26b964f" class="i method">GetEnumerator</a>() =&gt; <a href="#994152c5aac791d0" class="i method">GetEnumerator</a>();
 
        <b>public virtual bool</b> <a id="e44cde7670e4acc0" href="../../../R/e44cde7670e4acc0.html" target="n" data-glyph="72,1" class="i method">TryGet</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">key</span>, <b>out string</b> <span id="r4 rd" class="r4 r">value</span>) =&gt; <a href="#daa14005712a8bf5" class="i property">Data</a>.<a href="@1@System.Runtime/A.html#6b9f9049901aacea" class="i method">TryGetValue</a>(<span class="r3 r">key</span>, <b>out</b> <span class="r4 r">value</span>);
 
        <b>public virtual void</b> <a id="d15fddbe8df74156" href="../../../R/d15fddbe8df74156.html" target="n" data-glyph="72,1" class="i method">Set</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r5 rd" class="r5 r">key</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r6 rd" class="r6 r">value</span>) =&gt; <a href="#daa14005712a8bf5" class="i property">Data</a><a href="@1@System.Runtime/A.html#86884956b17e491a">[</a><span class="r5 r">key</span>] = <span class="r6 r">value</span>;
 
        <b>public virtual void</b> <a id="8e0c3c6612013049" href="../../../R/8e0c3c6612013049.html" target="n" data-glyph="72,1" class="i method">Load</a>()
        {
        }
 
        <b>public virtual</b> <a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="a6f2c69f3269c877" href="../../../R/a6f2c69f3269c877.html" target="n" data-glyph="72,1" class="i method">GetChildKeys</a>(<a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r7 rd" class="r7 r">earlierKeys</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r8 rd" class="r8 r">parentPath</span>)
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r9 rd" class="r9 r">prefix</span> = <span class="r8 r">parentPath</span> == <b>null</b> ? <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a> : <span class="r8 r">parentPath</span> + <span class="t t">ConfigurationPath</span>.<span class="i field">KeyDelimiter</span>;
 
            <b>return</b> <a href="#daa14005712a8bf5" class="i property">Data</a>
                .<span class="i method">Where</span>(<span id="r10 rd" class="r10 r">kv</span> =&gt; <span class="r10 r">kv</span>.<a href="@1@System.Runtime/A.html#f9d1c04feb1af032" class="i property">Key</a>.<a href="@1@System.Runtime/A.html#1c787ba07a7b11ab" class="i method">StartsWith</a>(<span class="r9 r">prefix</span>, <a href="@1@System.Runtime/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@1@System.Runtime/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
                .<span class="i method">Select</span>(<span id="r11 rd" class="r11 r">kv</span> =&gt; <a href="#4262d413b0ff3fe7" class="i method">Segment</a>(<span class="r11 r">kv</span>.<a href="@1@System.Runtime/A.html#f9d1c04feb1af032" class="i property">Key</a>, <span class="r9 r">prefix</span>.<a href="@1@System.Runtime/A.html#e13f5829ef28aa07" class="i property">Length</a>))
                .<span class="i method">Concat</span>(<span class="r7 r">earlierKeys</span>)
                .<span class="i method">OrderBy</span>(<span id="r12 rd" class="r12 r">k</span> =&gt; <span class="r12 r">k</span>, <span class="t t">ConfigurationKeyComparer</span>.<span class="i property">Instance</span>);
        }
 
        <b>private static string</b> <a id="4262d413b0ff3fe7" href="../../../R/4262d413b0ff3fe7.html" target="n" data-glyph="76,1" class="i method">Segment</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r13 rd" class="r13 r">key</span>, <b>int</b> <span id="r14 rd" class="r14 r">prefixLength</span>)
        {
            <a href="@1@System.Runtime/A.html#225942ed7b7a3252" class="k">var</a> <span id="r15 rd" class="r15 r">indexOf</span> = <span class="r13 r">key</span>.<a href="@1@System.Runtime/A.html#3b7fbc076e08ccb8" class="i method">IndexOf</a>(<span class="t t">ConfigurationPath</span>.<span class="i field">KeyDelimiter</span>, <span class="r14 r">prefixLength</span>, <a href="@1@System.Runtime/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@1@System.Runtime/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>);
            <b>return</b> <span class="r15 r">indexOf</span> &lt; 0 ? <span class="r13 r">key</span>.<a href="@1@System.Runtime/A.html#882fa7998d6ca35a" class="i method">Substring</a>(<span class="r14 r">prefixLength</span>) : <span class="r13 r">key</span>.<a href="@1@System.Runtime/A.html#8124961f027d9ac9" class="i method">Substring</a>(<span class="r14 r">prefixLength</span>, <span class="r15 r">indexOf</span> - <span class="r14 r">prefixLength</span>);
        }
 
        <b>public</b> <span class="t t">IChangeToken</span> <a id="4bf431986195ceaa" href="../../../R/4bf431986195ceaa.html" target="n" data-glyph="72,1" class="i method">GetReloadToken</a>()
        {
            <b>return</b> <a href="#49906eb23a464a03" class="i field">_reloadToken</a>;
        }
 
        <b>protected void</b> <a id="1f8cd017388eb96f" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">OnReload</a>()
        {
            <b>var</b> <span id="r16 rd" class="r16 r">previousToken</span> = <span class="t t">Interlocked</span>.<span class="i method">Exchange</span>(<b>ref</b> <a href="#49906eb23a464a03" class="i field">_reloadToken</a>, <b>new</b> <span class="t constructor">ConfigurationReloadToken</span>());
            <span class="r16 r">previousToken</span>.<span class="i method">OnReload</span>();
        }
 
        <b>public override string</b> <a id="5bb70780ba999d4c" href="../../../R/5bb70780ba999d4c.html" target="n" data-glyph="72,1" class="i method">ToString</a>() =&gt; <span class="s">$&quot;</span>{<a href="@1@System.Runtime/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@1@System.Runtime/A.html#aa4f112f79364b6e" class="i property">Name</a>}<span class="s">&quot;</span>;
    }
}
</pre></td></tr></table></div></body></html>
