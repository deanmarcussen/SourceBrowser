<!DOCTYPE html>
<html><head><title>IDocumentStore.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(51);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.Data.Abstractions/Documents/IDocumentStore.cs" target="_top">Documents\IDocumentStore.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.Data.Abstractions" target="_top">src\OrchardCore\OrchardCore.Data.Abstractions\OrchardCore.Data.Abstractions.csproj</a> (OrchardCore.Data.Abstractions)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">Data</span>.<span class="i n">Documents</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A cacheable, committable and cancellable document store allowing to get documents from a shared cache while being able</span>
    <span class="c">///</span><span class="c"> to update them to the store at the scope level, and allowing to register delegates that get called after committing.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public interface</b> <a id="a202a4811fda6752" href="../R/a202a4811fda6752.html" target="n" data-glyph="48,0" class="t t">IDocumentStore</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Loads a single document (or create a new one) for updating and that should not be cached.</span>
        <span class="c">///</span><span class="c"> For a full isolation, it needs to be used in pair with </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b5be5308ecdd1b1e" class="i method">GetOrCreateImmutableAsync</a>{<span class="r0 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="@1@System.Runtime/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="r1 r t">T</span>&gt; <a id="232de12dbaad13b7" href="../R/232de12dbaad13b7.html" target="n" data-glyph="72,1" class="i method">GetOrCreateMutableAsync</a>&lt;<span id="r1 rd t" class="r1 r t">T</span>&gt;(<a href="@1@System.Runtime/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<a href="@1@System.Runtime/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="r1 r t">T</span>&gt;&gt; <span id="r2 rd" class="r2 r">factoryAsync</span> = <b>null</b>) <b>where</b> <span class="r1 r t">T</span> : <b>class</b>, <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a single document (or create a new one) for caching and that should not be updated,</span>
        <span class="c">///</span><span class="c"> and a bool indicating if it can be cached, not if it has been already loaded for update.</span>
        <span class="c">///</span><span class="c"> For a full isolation, it needs to be used in pair with </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#232de12dbaad13b7" class="i method">GetOrCreateMutableAsync</a>{<span class="r3 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="@1@System.Runtime/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;(<b>bool</b>, <span class="r4 r t">T</span>)&gt; <a id="b5be5308ecdd1b1e" href="../R/b5be5308ecdd1b1e.html" target="n" data-glyph="72,1" class="i method">GetOrCreateImmutableAsync</a>&lt;<span id="r4 rd t" class="r4 r t">T</span>&gt;(<a href="@1@System.Runtime/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<a href="@1@System.Runtime/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="r4 r t">T</span>&gt;&gt; <span id="r5 rd" class="r5 r">factoryAsync</span> = <b>null</b>) <b>where</b> <span class="r4 r t">T</span> : <b>class</b>, <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Updates the store with the provided document and then uses the delegate to update the cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="@1@System.Runtime/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f418829618a1fa97" href="../R/f418829618a1fa97.html" target="n" data-glyph="72,1" class="i method">UpdateAsync</a>&lt;<span id="r6 rd t" class="r6 r t">T</span>&gt;(<span class="r6 r t">T</span> <span id="r7 rd" class="r7 r">document</span>, <a href="@1@System.Runtime/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<span class="r6 r t">T</span>, <a href="@1@System.Runtime/A.html#045a746eb48cbaa9" class="t t">Task</a>&gt; <span id="r8 rd" class="r8 r">updateCache</span>, <b>bool</b> <span id="r9 rd" class="r9 r">checkConcurrency</span> = <b>false</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allows to cancel the current updating before calling </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e3808e539272f60c" class="i method">CommitAsync</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> at the end of the scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="@1@System.Runtime/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="cb51ab7e89414bf8" href="../R/cb51ab7e89414bf8.html" target="n" data-glyph="72,1" class="i method">CancelAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Registers a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="DocumentStoreCommitSuccessDelegate.cs.html#1cca2d805353d9ac" class="t t">DocumentStoreCommitSuccessDelegate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that will get called after </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e3808e539272f60c" class="i method">CommitAsync</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if it succeeded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>void</b> <a id="6256e75512a6c9e8" href="../R/6256e75512a6c9e8.html" target="n" data-glyph="72,1" class="i method">AfterCommitSuccess</a>&lt;<span id="r10 rd t" class="r10 r t">T</span>&gt;(<a href="DocumentStoreCommitSuccessDelegate.cs.html#1cca2d805353d9ac" class="t t">DocumentStoreCommitSuccessDelegate</a> <span id="r11 rd" class="r11 r">afterCommit</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Registers a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="DocumentStoreCommitFailureDelegate.cs.html#66f4383fa2357fb5" class="t t">DocumentStoreCommitFailureDelegate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that will get called after </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e3808e539272f60c" class="i method">CommitAsync</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if it failed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>void</b> <a id="c26289b9b730183a" href="../R/c26289b9b730183a.html" target="n" data-glyph="72,1" class="i method">AfterCommitFailure</a>&lt;<span id="r12 rd t" class="r12 r t">T</span>&gt;(<a href="DocumentStoreCommitFailureDelegate.cs.html#66f4383fa2357fb5" class="t t">DocumentStoreCommitFailureDelegate</a> <span id="r13 rd" class="r13 r">afterCommit</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Commits the related document store.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="@1@System.Runtime/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="e3808e539272f60c" href="../R/e3808e539272f60c.html" target="n" data-glyph="72,1" class="i method">CommitAsync</a>();
    }
}
</pre></td></tr></table></div></body></html>
