<!DOCTYPE html>
<html><head><title>WorkflowExecutionContext.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(128);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.Workflows.Abstractions/Models/WorkflowExecutionContext.cs" target="_top">Models\WorkflowExecutionContext.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.Workflows.Abstractions" target="_top">src\OrchardCore\OrchardCore.Workflows.Abstractions\OrchardCore.Workflows.Abstractions.csproj</a> (OrchardCore.Workflows.Abstractions)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">Workflows</span>.<span class="i n">Models</span>
{
    <b>public class</b> <a id="6f67695a3f6cde25" href="../R/6f67695a3f6cde25.html" target="n" data-glyph="0,0" class="t t">WorkflowExecutionContext</a>
    {
        <b>public</b> <a id="da1c0487d0d95cd3" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">WorkflowExecutionContext</a>
        (
            <a href="WorkflowType.cs.html#0d529cb8d2493970" class="t t">WorkflowType</a> <span id="r0 rd" class="r0 r">workflowType</span>,
            <a href="Workflow.cs.html#9d11fe1821b79f9c" class="t t">Workflow</a> <span id="r1 rd" class="r1 r">workflow</span>,
            <a href="@1@System.Runtime/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <span id="r2 rd" class="r2 r">input</span>,
            <a href="@1@System.Runtime/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <span id="r3 rd" class="r3 r">output</span>,
            <a href="@1@System.Runtime/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <span id="r4 rd" class="r4 r">properties</span>,
            <a href="@1@System.Runtime/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="ExecutedActivity.cs.html#18dc703e68f6bf0e" class="t t">ExecutedActivity</a>&gt; <span id="r5 rd" class="r5 r">executedActivities</span>,
            <b>object</b> <span id="r6 rd" class="r6 r">lastResult</span>,
            <a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="ActivityContext.cs.html#9e67ef319c1dd26d" class="t t">ActivityContext</a>&gt; <span id="r7 rd" class="r7 r">activities</span>
        )
        {
            <a href="#64ee46bac4f58d2e" class="i property">Input</a> = <span class="r2 r">input</span> ?? <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;();
            <a href="#e4b3f7e4864ffeaf" class="i property">Output</a> = <span class="r3 r">output</span> ?? <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;();
            <a href="#0074bb9854d7ed80" class="i property">Properties</a> = <span class="r4 r">properties</span> ?? <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;();
            <a href="#9100530beee32dd5" class="i property">ExecutedActivities</a> = <b>new</b> <span class="t constructor">Stack</span>&lt;<a href="ExecutedActivity.cs.html#18dc703e68f6bf0e" class="t t">ExecutedActivity</a>&gt;(<span class="r5 r">executedActivities</span> ?? <b>new</b> <span class="t constructor">List</span>&lt;<a href="ExecutedActivity.cs.html#18dc703e68f6bf0e" class="t t">ExecutedActivity</a>&gt;());
            <a href="#3d784f37085b00d7" class="i property">LastResult</a> = <span class="r6 r">lastResult</span>;
            <a href="#5b7cec2fb715fe6a" class="i property">WorkflowType</a> = <span class="r0 r">workflowType</span>;
            <a href="#c35139b3c848617c" class="i property">Workflow</a> = <span class="r1 r">workflow</span>;
            <a href="#fce9097271d914f3" class="i property">Activities</a> = <span class="r7 r">activities</span>.<span class="i method">ToDictionary</span>(<span id="r8 rd" class="r8 r">x</span> =&gt; <span class="r8 r">x</span>.<a href="ActivityContext.cs.html#755619f39e6b098a" class="i property">ActivityRecord</a>.<a href="ActivityRecord.cs.html#038a862a28690a6c" class="i property">ActivityId</a>);
        }
 
        <b>public</b> <a href="Workflow.cs.html#9d11fe1821b79f9c" class="t t">Workflow</a> <a id="c35139b3c848617c" href="../R/c35139b3c848617c.html" target="n" data-glyph="102,1" class="i property">Workflow</a> { <b>get</b>; }
        <b>public</b> <a href="WorkflowType.cs.html#0d529cb8d2493970" class="t t">WorkflowType</a> <a id="5b7cec2fb715fe6a" href="../R/5b7cec2fb715fe6a.html" target="n" data-glyph="102,1" class="i property">WorkflowType</a> { <b>get</b>; }
        <b>public</b> <a href="@1@System.Runtime/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="ActivityContext.cs.html#9e67ef319c1dd26d" class="t t">ActivityContext</a>&gt; <a id="fce9097271d914f3" href="../R/fce9097271d914f3.html" target="n" data-glyph="102,1" class="i property">Activities</a> { <b>get</b>; }
 
        <b>public string</b> <a id="11e6090ca7af007e" href="../R/11e6090ca7af007e.html" target="n" data-glyph="102,1" class="i property">WorkflowId</a>
        {
            <b>get</b> =&gt; <a href="#c35139b3c848617c" class="i property">Workflow</a>.<a href="Workflow.cs.html#508f217c03b9c081" class="i property">WorkflowId</a>;
        }
 
        <b>public string</b> <a id="568071871df1f194" href="../R/568071871df1f194.html" target="n" data-glyph="102,1" class="i property">CorrelationId</a>
        {
            <b>get</b> =&gt; <a href="#c35139b3c848617c" class="i property">Workflow</a>.<a href="Workflow.cs.html#729696542b0289cf" class="i property">CorrelationId</a>;
            <b>set</b> =&gt; <a href="#c35139b3c848617c" class="i property">Workflow</a>.<a href="Workflow.cs.html#729696542b0289cf" class="i property">CorrelationId</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A dictionary of re-hydrated values provided by the initiator of the workflow.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@System.Runtime/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <a id="64ee46bac4f58d2e" href="../R/64ee46bac4f58d2e.html" target="n" data-glyph="102,1" class="i property">Input</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A dictionary of re-hydrated values provided to the initiator of the workflow.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@System.Runtime/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <a id="e4b3f7e4864ffeaf" href="../R/e4b3f7e4864ffeaf.html" target="n" data-glyph="102,1" class="i property">Output</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A dictionary of re-hydrated values provided by the workflow activities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@System.Runtime/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <a id="0074bb9854d7ed80" href="../R/0074bb9854d7ed80.html" target="n" data-glyph="102,1" class="i property">Properties</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value returned from the previous activity, if any.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="3d784f37085b00d7" href="../R/3d784f37085b00d7.html" target="n" data-glyph="102,1" class="i property">LastResult</a> { <b>get</b>; <b>set</b>; }
 
        <b>public</b> <a href="WorkflowStatus.cs.html#3a55ab749d1f5088" class="t t">WorkflowStatus</a> <a id="3b520b13a901add5" href="../R/3b520b13a901add5.html" target="n" data-glyph="102,1" class="i property">Status</a>
        {
            <b>get</b> =&gt; <a href="#c35139b3c848617c" class="i property">Workflow</a>.<a href="Workflow.cs.html#cbe7f8f5ebffc87c" class="i property">Status</a>;
            <b>set</b> =&gt; <a href="#c35139b3c848617c" class="i property">Workflow</a>.<a href="Workflow.cs.html#cbe7f8f5ebffc87c" class="i property">Status</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Keeps track of which activities executed in which order.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="t t">Stack</span>&lt;<a href="ExecutedActivity.cs.html#18dc703e68f6bf0e" class="t t">ExecutedActivity</a>&gt; <a id="9100530beee32dd5" href="../R/9100530beee32dd5.html" target="n" data-glyph="102,1" class="i property">ExecutedActivities</a> { <b>get</b>; <b>set</b>; }
 
        <b>public</b> <a href="ActivityContext.cs.html#9e67ef319c1dd26d" class="t t">ActivityContext</a> <a id="ceca6b4543f30109" href="../R/ceca6b4543f30109.html" target="n" data-glyph="72,1" class="i method">GetActivity</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r9 rd" class="r9 r">activityId</span>)
        {
            <b>return</b> <a href="#fce9097271d914f3" class="i property">Activities</a><a href="@1@System.Runtime/A.html#86884956b17e491a">[</a><span class="r9 r">activityId</span>];
        }
 
        <b>public void</b> <a id="b882d7723ce6febc" href="../R/b882d7723ce6febc.html" target="n" data-glyph="72,1" class="i method">Fault</a>(<a href="@1@System.Runtime/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r10 rd" class="r10 r">exception</span>, <a href="ActivityContext.cs.html#9e67ef319c1dd26d" class="t t">ActivityContext</a> <span id="r11 rd" class="r11 r">activityContext</span>)
        {
            <a href="#c35139b3c848617c" class="i property">Workflow</a>.<a href="Workflow.cs.html#cbe7f8f5ebffc87c" class="i property">Status</a> = <a href="WorkflowStatus.cs.html#3a55ab749d1f5088" class="t t">WorkflowStatus</a>.<a href="WorkflowStatus.cs.html#74f556e7a92e197f" class="i field">Faulted</a>;
            <a href="#c35139b3c848617c" class="i property">Workflow</a>.<a href="Workflow.cs.html#3895f886b6371871" class="i property">FaultMessage</a> = <span class="r10 r">exception</span>.<a href="@1@System.Runtime/A.html#5fba0e16215b42a3" class="i property">Message</a>;
        }
 
        <b>public</b> <a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="Transition.cs.html#e0312b073d6be8b6" class="t t">Transition</a>&gt; <a id="724a0d892910bf1e" href="../R/724a0d892910bf1e.html" target="n" data-glyph="72,1" class="i method">GetInboundTransitions</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r12 rd" class="r12 r">activityId</span>)
        {
            <b>return</b> <a href="#5b7cec2fb715fe6a" class="i property">WorkflowType</a>.<a href="WorkflowType.cs.html#e3406b475ff800e2" class="i property">Transitions</a>.<span class="i method">Where</span>(<span id="r13 rd" class="r13 r">x</span> =&gt; <span class="r13 r">x</span>.<a href="Transition.cs.html#9b2153ffdeca333f" class="i property">DestinationActivityId</a> == <span class="r12 r">activityId</span>).<span class="i method">ToList</span>();
        }
 
        <b>public</b> <a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="Transition.cs.html#e0312b073d6be8b6" class="t t">Transition</a>&gt; <a id="2b049ba7e3aae21c" href="../R/2b049ba7e3aae21c.html" target="n" data-glyph="72,1" class="i method">GetOutboundTransitions</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">activityId</span>)
        {
            <b>return</b> <a href="#5b7cec2fb715fe6a" class="i property">WorkflowType</a>.<a href="WorkflowType.cs.html#e3406b475ff800e2" class="i property">Transitions</a>.<span class="i method">Where</span>(<span id="r15 rd" class="r15 r">x</span> =&gt; <span class="r15 r">x</span>.<a href="Transition.cs.html#48c43e2184d42866" class="i property">SourceActivityId</a> == <span class="r14 r">activityId</span>).<span class="i method">ToList</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the full path of incoming activities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="fab7e73f61d923e7" href="../R/fab7e73f61d923e7.html" target="n" data-glyph="72,1" class="i method">GetInboundActivityPath</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r16 rd" class="r16 r">activityId</span>)
        {
            <b>return</b> <a href="#accc6011268db58f" class="i method">GetInboundActivityPathInternal</a>(<span class="r16 r">activityId</span>, <span class="r16 r">activityId</span>).<span class="i method">Distinct</span>().<span class="i method">ToList</span>();
        }
 
        <b>private</b> <a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="accc6011268db58f" href="../R/accc6011268db58f.html" target="n" data-glyph="76,1" class="i method">GetInboundActivityPathInternal</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r17 rd" class="r17 r">activityId</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r18 rd" class="r18 r">startingPointActivityId</span>)
        {
            <b>foreach</b> (<a href="Transition.cs.html#e0312b073d6be8b6" class="k">var</a> <span id="r19 rd" class="r19 r">transition</span> <b>in</b> <a href="#724a0d892910bf1e" class="i method">GetInboundTransitions</a>(<span class="r17 r">activityId</span>))
            {
                <span class="c">// Circuit breaker: Detect workflows that implement repeating flows to prevent an infinite loop here.</span>
                <b>if</b> (<span class="r19 r">transition</span>.<a href="Transition.cs.html#48c43e2184d42866" class="i property">SourceActivityId</a> == <span class="r18 r">startingPointActivityId</span>)
                {
                    <b>yield</b> <b>break</b>;
                }
                <b>else</b>
                {
                    <b>yield</b> <b>return</b> <span class="r19 r">transition</span>.<a href="Transition.cs.html#48c43e2184d42866" class="i property">SourceActivityId</a>;
 
                    <b>foreach</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r20 rd" class="r20 r">parentActivityId</span> <b>in</b> <a href="#accc6011268db58f" class="i method">GetInboundActivityPathInternal</a>(<span class="r19 r">transition</span>.<a href="Transition.cs.html#48c43e2184d42866" class="i property">SourceActivityId</a>, <span class="r18 r">startingPointActivityId</span>).<span class="i method">Distinct</span>())
                    {
                        <b>yield</b> <b>return</b> <span class="r20 r">parentActivityId</span>;
                    }
                }
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
