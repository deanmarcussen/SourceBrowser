<!DOCTYPE html>
<html><head><title>Startup.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(70);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.Alias/Startup.cs" target="_top">Startup.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.Alias" target="_top">src\OrchardCore.Modules\OrchardCore.Alias\OrchardCore.Alias.csproj</a> (OrchardCore.Alias)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">Fluid</span>;
<b>using</b> <span class="i">Fluid</span>.<span class="i">Values</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">DependencyInjection</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>.<span class="i n">Drivers</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>.<span class="i n">Handlers</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>.<span class="i n">Indexes</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>.<span class="i n">Indexing</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>.<span class="i n">Services</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>.<span class="i n">Settings</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>.<span class="i n">ViewModels</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ContentManagement</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ContentManagement</span>.<span class="i">Display</span>.<span class="i">ContentDisplay</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">ContentTypes</span>.<span class="i n">Editors</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Data</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Data</span>.<span class="i n">Migration</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Indexing</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">Liquid</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i">Modules</span>;
<b>using</b> <span class="i">YesSql</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">Alias</span>
{
    <b>public class</b> <a id="a7ebd7a6b27b381e" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="4d2a37a484105e62">Startup</span></a> : <span class="i">StartupBase</span>
    {
        <b>public override void</b> <a id="f9abf93d3ad81779" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ConfigureServices</a>(<span class="t t">IServiceCollection</span> <span id="r0 rd" class="r0 r">services</span>)
        {
            <span class="r0 r">services</span>.<span class="i method">Configure</span>&lt;<span class="i">TemplateOptions</span>&gt;(<span id="r1 rd" class="r1 r">o</span> =&gt;
            {
                <span class="r1 r">o</span>.<span class="i">MemberAccessStrategy</span>.<span class="i">Register</span>&lt;<a href="ViewModels/AliasPartViewModel.cs.html#e071a5de72f81521" class="t t">AliasPartViewModel</a>&gt;();
 
                <span class="r1 r">o</span>.<span class="i">MemberAccessStrategy</span>.<span class="i">Register</span>&lt;<a href="/OrchardCore.Liquid.Abstractions/A.html#81d9791dc0fbd3b2" class="t t">LiquidContentAccessor</a>, <a href="/OrchardCore.Liquid.Abstractions/A.html#a44f08e82995471c" class="t t">LiquidPropertyAccessor</a>&gt;(<span class="s">&quot;Alias&quot;</span>, (<span id="r2 rd" class="r2 r">obj</span>, <span id="r3 rd" class="r3 r">context</span>) =&gt;
                {
                    <a href="/OrchardCore.Liquid.Abstractions/A.html#e17bfc00558bbb3a" class="k">var</a> <span id="r4 rd" class="r4 r">liquidTemplateContext</span> = (<a href="/OrchardCore.Liquid.Abstractions/A.html#e17bfc00558bbb3a" class="t t">LiquidTemplateContext</a>)<span class="r3 r">context</span>;
 
                    <b>return</b> <b>new</b> <span class="t">LiquidPropertyAccessor</span>(<span class="r4 r">liquidTemplateContext</span>, <b>async</b> (<span id="r5 rd" class="r5 r">alias</span>, <span id="r6 rd" class="r6 r">context</span>) =&gt;
                    {
                        <b>var</b> <span id="r7 rd" class="r7 r">session</span> = <span class="r6 r">context</span>.<a href="/OrchardCore.Liquid.Abstractions/A.html#35b8fed4ca686dda" class="i property">Services</a>.<span class="i method">GetRequiredService</span>&lt;<span class="i">ISession</span>&gt;();
 
                        <b>var</b> <span id="r8 rd" class="r8 r">contentItem</span> = <b>await</b> <span class="r7 r">session</span>.<span class="i">Query</span>&lt;<a href="/OrchardCore.ContentManagement.Abstractions/A.html#1099e5a609a8b2e4" class="t t">ContentItem</a>, <a href="Indexes/AliasPartIndex.cs.html#963cb770e38c4cc6" class="t t">AliasPartIndex</a>&gt;(<span id="r9 rd" class="r9 r">x</span> =&gt;
                            <span class="r9 r">x</span>.<span class="i">Published</span> &amp;&amp; <span class="r9 r">x</span>.<span class="i">Alias</span> == <span class="r5 r">alias</span>.<a href="@1@System.Runtime/A.html#2d51c212cb09178e" class="i method">ToLowerInvariant</a>())
                        .<span class="i">FirstOrDefaultAsync</span>();
 
                        <b>if</b> (<span class="r8 r">contentItem</span> == <b>null</b>)
                        {
                            <b>return</b> <span class="i">NilValue</span>.<span class="i">Instance</span>;
                        }
 
                        <a href="/OrchardCore.ContentManagement.Abstractions/A.html#6ca840219d8dc4cd" class="k">var</a> <span id="r10 rd" class="r10 r">contentManager</span> = <span class="r6 r">context</span>.<a href="/OrchardCore.Liquid.Abstractions/A.html#35b8fed4ca686dda" class="i property">Services</a>.<span class="i method">GetRequiredService</span>&lt;<a href="/OrchardCore.ContentManagement.Abstractions/A.html#6ca840219d8dc4cd" class="t t">IContentManager</a>&gt;();
                        <span class="r8 r">contentItem</span> = <b>await</b> <span class="r10 r">contentManager</span>.<span class="i">LoadAsync</span>(<span class="r8 r">contentItem</span>);
 
                        <b>return</b> <b>new</b> <span class="i">ObjectValue</span>(<span class="r8 r">contentItem</span>);
                    });
                });
            });
            <span class="r0 r">services</span>.<span class="i">AddScoped</span>&lt;<span class="i">IScopedIndexProvider</span>, <a href="Indexes/AliasPartIndex.cs.html#9173ac80e72bcf44" class="t t">AliasPartIndexProvider</a>&gt;();
            <span class="r0 r">services</span>.<span class="i">AddScoped</span>&lt;<span class="i">IDataMigration</span>, <a href="Migrations.cs.html#68a840a8aa44d4e4" class="t t">Migrations</a>&gt;();
            <span class="r0 r">services</span>.<span class="i method">AddScoped</span>&lt;<a href="/OrchardCore.ContentManagement.Abstractions/A.html#add47e186a57296c" class="t t">IContentHandleProvider</a>, <a href="Services/AliasPartContentHandleProvider.cs.html#7df9aba68c6ba6e2" class="t t">AliasPartContentHandleProvider</a>&gt;();
 
            <span class="c">// Identity Part</span>
            <span class="r0 r">services</span>.<a href="/OrchardCore.ContentManagement.Abstractions/A.html#0019d3c1a0518f06" class="i method">AddContentPart</a>&lt;<a href="Models/AliasPart.cs.html#99460d5ec41e79f2" class="t t">AliasPart</a>&gt;()
                .<span class="i">UseDisplayDriver</span>&lt;<a href="Drivers/AliasPartDisplayDriver.cs.html#aef15f21a4710e2d" class="t t">AliasPartDisplayDriver</a>&gt;()
                .<span class="i">AddHandler</span>&lt;<a href="Handlers/AliasPartHandler.cs.html#ef2047af6390a1ed" class="t t">AliasPartHandler</a>&gt;();
 
            <span class="r0 r">services</span>.<span class="i method">AddScoped</span>&lt;<a href="/OrchardCore.Indexing.Abstractions/A.html#d17781887b83d515" class="t t">IContentPartIndexHandler</a>, <a href="Indexing/AliasPartIndexHandler.cs.html#9f24d0632936f601" class="t t">AliasPartIndexHandler</a>&gt;();
            <span class="r0 r">services</span>.<span class="i">AddScoped</span>&lt;<a href="/OrchardCore.ContentTypes.Abstractions/A.html#dd1845d853c10401" class="t t">IContentTypePartDefinitionDisplayDriver</a>, <a href="Settings/AliasPartSettingsDisplayDriver.cs.html#b0ec8003f997ede0" class="t t">AliasPartSettingsDisplayDriver</a>&gt;();
        }
    }
}
</pre></td></tr></table></div></body></html>
