<!DOCTYPE html>
<html><head><title>ThemeLayout.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(63);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.DisplayManagement/Theming/ThemeLayout.cs" target="_top">Theming\ThemeLayout.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.DisplayManagement" target="_top">src\OrchardCore\OrchardCore.DisplayManagement\OrchardCore.DisplayManagement.csproj</a> (OrchardCore.DisplayManagement)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">AspNetCore</span>.<span class="i n">Html</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">DisplayManagement</span>.<span class="i n">Theming</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class represents a precompiled _Layout.cshtml view that renders a</span>
    <span class="c">///</span><span class="c"> Layout shape and the View&#39;s body in its Content zone.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> 1- Views look for any _ViewStart.cshtml</span>
    <span class="c">///</span><span class="c"> 2- </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ThemingViewsFeatureProvider.cs.html#2bfb3e3be6881b14" class="t t">ThemingViewsFeatureProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> has registered </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ThemeViewStart.cs.html#1d80e2a13da12622" class="t t">ThemeViewStart</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> as the top one</span>
    <span class="c">///</span><span class="c"> 3- </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ThemeViewStart.cs.html#1d80e2a13da12622" class="t t">ThemeViewStart</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> then set a special Layout filename as the default View&#39;s Layout.</span>
    <span class="c">///</span><span class="c"> 4- </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ThemingViewsFeatureProvider.cs.html#2bfb3e3be6881b14" class="t t">ThemingViewsFeatureProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> has registered </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#838454a0f51430f9" class="t t">ThemeLayout</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for this special filename.</span>
    <span class="c">///</span><span class="c"> 5- </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#838454a0f51430f9" class="t t">ThemeLayout</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> evaluates the Body of the view, and renders a Layout shape with this Body in the Content zone.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="838454a0f51430f9" href="../R/838454a0f51430f9.html" target="n" data-glyph="0,0" class="t t"><span id="97d34bbb40878b3e">ThemeLayout</span></a> : <span class="i n">Razor</span>.<a href="../Razor/RazorPage.cs.html#854716de6b230a14" class="t t">RazorPage</a>&lt;<b>dynamic</b>&gt;
    {
        <b>public override async</b> <a href="@1@System.Runtime/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="7e53dd944741fbe6" href="../R/7e53dd944741fbe6.html" target="n" data-glyph="72,1" class="i method">ExecuteAsync</a>()
        {
            <span class="c">// The View&#39;s body is rendered.</span>
            <b>var</b> <span id="r0 rd" class="r0 r">body</span> = <a href="../Razor/RazorPage.cs.html#bb3982713f88bd0c" class="i method">RenderLayoutBody</a>();
 
            <b>if</b> (<a href="../Razor/RazorPage.cs.html#0fc8fee8eac9af51" class="i property">ThemeLayout</a> != <b>null</b>)
            {
                <span class="c">// Then is added to the Content zone of the Layout shape.</span>
                <b>await</b> <a href="../Razor/RazorPage.cs.html#0fc8fee8eac9af51" class="i property">ThemeLayout</a>.<a href="../Zones/ZoneHoldingBehavior.cs.html#43d22e96543b7e25" class="i property">Zones</a><a href="../Zones/ZoneHoldingBehavior.cs.html#26d913ee76532e50">[</a><span class="s">&quot;Content&quot;</span>].<a href="../IShape.cs.html#1e6178ba3901dbff" class="i method">AddAsync</a>(<span class="r0 r">body</span>);
 
                <span class="c">// Pre-render all shapes and replace the zone content with it.</span>
                <a href="../Razor/RazorPage.cs.html#0fc8fee8eac9af51" class="i property">ThemeLayout</a>.<a href="../Zones/ZoneHoldingBehavior.cs.html#43d22e96543b7e25" class="i property">Zones</a><a href="../Zones/ZoneHoldingBehavior.cs.html#26d913ee76532e50">[</a><span class="s">&quot;Content&quot;</span>] = <b>new</b> <a href="../PositionWrapper.cs.html#b4c5af16cf507cb6" class="t constructor">PositionWrapper</a>(<b>await</b> <a href="../Razor/RazorPage.cs.html#58e0a2b0fd07b2d2" class="i method">DisplayAsync</a>(<a href="../Razor/RazorPage.cs.html#0fc8fee8eac9af51" class="i property">ThemeLayout</a>.<a href="../Zones/ZoneHoldingBehavior.cs.html#43d22e96543b7e25" class="i property">Zones</a><a href="../Zones/ZoneHoldingBehavior.cs.html#26d913ee76532e50">[</a><span class="s">&quot;Content&quot;</span>]), <span class="s">&quot;&quot;</span>);
 
                <span class="c">// Render each layout zone.</span>
                <b>foreach</b> (<a href="@1@System.Runtime/A.html#8585965bb176a426" class="k">var</a> <span id="r1 rd" class="r1 r">zone</span> <b>in</b> <a href="../Razor/RazorPage.cs.html#0fc8fee8eac9af51" class="i property">ThemeLayout</a>.<a href="../IShape.cs.html#3acc733cb89c460c" class="i property">Properties</a>.<span class="i method">ToArray</span>())
                {
                    <b>if</b> (<span class="r1 r">zone</span>.<a href="@1@System.Runtime/A.html#38c0e86cc4b30170" class="i property">Value</a> <b>is</b> <a href="../IShape.cs.html#1b6ae4719962ce25" class="t t">IShape</a> <span id="r2 rd" class="r2 r">shape</span>)
                    {
                        <span class="c">// Check if the shape is null or empty.</span>
                        <b>if</b> (<span class="r2 r">shape</span>.<a href="../IShape.cs.html#d36fb2f5905c0dd3" class="i method">IsNullOrEmpty</a>())
                        {
                            <b>continue</b>;
                        }
 
                        <span class="c">// Check if the shape is pre-rendered.</span>
                        <b>if</b> (<span class="r2 r">shape</span> <b>is</b> <span class="t t">IHtmlContent</span>)
                        {
                            <b>continue</b>;
                        }
 
                        <a href="../Razor/RazorPage.cs.html#0fc8fee8eac9af51" class="i property">ThemeLayout</a>.<a href="../Zones/ZoneHoldingBehavior.cs.html#43d22e96543b7e25" class="i property">Zones</a><a href="../Zones/ZoneHoldingBehavior.cs.html#26d913ee76532e50">[</a><span class="r1 r">zone</span>.<a href="@1@System.Runtime/A.html#f9d1c04feb1af032" class="i property">Key</a>] = <b>new</b> <a href="../PositionWrapper.cs.html#b4c5af16cf507cb6" class="t constructor">PositionWrapper</a>(<b>await</b> <a href="../Razor/RazorPage.cs.html#58e0a2b0fd07b2d2" class="i method">DisplayAsync</a>(<span class="r2 r">shape</span>), <span class="s">&quot;&quot;</span>);
                    }
                }
 
                <span class="c">// Finally we render the Layout Shape&#39;s HTML to the page&#39;s output.</span>
                <span class="i method">Write</span>(<b>await</b> <a href="../Razor/RazorPage.cs.html#58e0a2b0fd07b2d2" class="i method">DisplayAsync</a>(<a href="../Razor/RazorPage.cs.html#0fc8fee8eac9af51" class="i property">ThemeLayout</a>));
            }
            <b>else</b>
            {
                <span class="i method">Write</span>(<span class="r0 r">body</span>);
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
