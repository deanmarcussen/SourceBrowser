<!DOCTYPE html>
<html><head><title>ShapeTablePlacementProvider.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(62);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.DisplayManagement/Descriptors/ShapeTablePlacementProvider.cs" target="_top">Descriptors\ShapeTablePlacementProvider.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.DisplayManagement" target="_top">src\OrchardCore\OrchardCore.DisplayManagement\OrchardCore.DisplayManagement.csproj</a> (OrchardCore.DisplayManagement)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">DisplayManagement</span>.<span class="i n">Handlers</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i n">DisplayManagement</span>.<span class="i n">Theming</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">DisplayManagement</span>.<span class="i n">Descriptors</span>
{
    <b>public class</b> <a id="0e7a53f835424dd7" href="../R/0e7a53f835424dd7.html" target="n" data-glyph="0,0" class="t t">ShapeTablePlacementProvider</a> : <a href="Interfaces.cs.html#dc8c39d7e3c9418a" class="t t">IShapePlacementProvider</a>
    {
        <b>private readonly</b> <a href="Interfaces.cs.html#f66024a4d4149e8d" class="t t">IShapeTableManager</a> <a id="8ae24a086703fbe1" href="../R/8ae24a086703fbe1.html" target="n" data-glyph="46,1" class="i field">_shapeTableManager</a>;
        <b>private readonly</b> <a href="../Theming/IThemeManager.cs.html#1a73ced9421ccec3" class="t t">IThemeManager</a> <a id="b700f36f4e0f8f5d" href="../R/b700f36f4e0f8f5d.html" target="n" data-glyph="46,1" class="i field">_themeManager</a>;
 
        <b>public</b> <a id="cd2c3cd1774772c4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ShapeTablePlacementProvider</a>(
            <a href="Interfaces.cs.html#f66024a4d4149e8d" class="t t">IShapeTableManager</a> <span id="r0 rd" class="r0 r">shapeTableManager</span>,
            <a href="../Theming/IThemeManager.cs.html#1a73ced9421ccec3" class="t t">IThemeManager</a> <span id="r1 rd" class="r1 r">themeManager</span>
            )
        {
            <a href="#8ae24a086703fbe1" class="i field">_shapeTableManager</a> = <span class="r0 r">shapeTableManager</span>;
            <a href="#b700f36f4e0f8f5d" class="i field">_themeManager</a> = <span class="r1 r">themeManager</span>;
        }
 
        <b>public async</b> <a href="@1@System.Runtime/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="Interfaces.cs.html#21daeeb83e1d832a" class="t t">IPlacementInfoResolver</a>&gt; <a id="588f2d100b310fed" href="../R/588f2d100b310fed.html" target="n" data-glyph="72,1" class="i method">BuildPlacementInfoResolverAsync</a>(<a href="../Handlers/IBuildShapeContext.cs.html#440581352c3e294c" class="t t">IBuildShapeContext</a> <span id="r2 rd" class="r2 r">context</span>)
        {
            <b>var</b> <span id="r3 rd" class="r3 r">theme</span> = <b>await</b> <a href="#b700f36f4e0f8f5d" class="i field">_themeManager</a>.<a href="../Theming/IThemeManager.cs.html#7ae9280f1451c804" class="i method">GetThemeAsync</a>();
 
            <span class="c">// If there is no active theme, do nothing</span>
            <b>if</b> (<span class="r3 r">theme</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="ShapeTable.cs.html#648363323db1f473" class="k">var</a> <span id="r4 rd" class="r4 r">shapeTable</span> = <a href="#8ae24a086703fbe1" class="i field">_shapeTableManager</a>.<span class="i">GetShapeTable</span>(<span class="r3 r">theme</span>.<span class="i">Id</span>);
 
            <b>return</b> <b>new</b> <a href="#e3d34021b0cd532b" class="t constructor">ShapeTablePlacementResolver</a>(<span class="r4 r">shapeTable</span>);
        }
 
        <b>private class</b> <a id="ce44d9da270d37d5" href="../R/ce44d9da270d37d5.html" target="n" data-glyph="4,1" class="t t">ShapeTablePlacementResolver</a> : <a href="Interfaces.cs.html#21daeeb83e1d832a" class="t t">IPlacementInfoResolver</a>
        {
            <b>private readonly</b> <a href="ShapeTable.cs.html#648363323db1f473" class="t t">ShapeTable</a> <a id="14dde5a17cbe4e28" href="../R/14dde5a17cbe4e28.html" target="n" data-glyph="46,2" class="i field">_shapeTable</a>;
 
            <b>internal</b> <a id="e3d34021b0cd532b" href="../R/e3d34021b0cd532b.html" target="n" data-glyph="74,2" class="t constructor">ShapeTablePlacementResolver</a>(<a href="ShapeTable.cs.html#648363323db1f473" class="t t">ShapeTable</a> <span id="r5 rd" class="r5 r">shapeTable</span>)
            {
                <a href="#14dde5a17cbe4e28" class="i field">_shapeTable</a> = <span class="r5 r">shapeTable</span>;
            }
 
            <b>public</b> <a href="PlacementInfo.cs.html#b3deb872be78af9d" class="t t">PlacementInfo</a> <a id="234d939f64ffddd1" href="../R/234d939f64ffddd1.html" target="n" data-glyph="72,2" class="i method">ResolvePlacement</a>(<a href="ShapeAlterationBuilder.cs.html#c9e3b8f174b6d011" class="t t">ShapePlacementContext</a> <span id="r6 rd" class="r6 r">placementContext</span>)
            {
                <b>if</b> (<a href="#14dde5a17cbe4e28" class="i field">_shapeTable</a>.<a href="ShapeTable.cs.html#3878e12224a90c13" class="i property">Descriptors</a>.<span class="i method">TryGetValue</span>(<span class="r6 r">placementContext</span>.<a href="ShapeAlterationBuilder.cs.html#176d1115e8096f5d" class="i property">ShapeType</a>, <b>out</b> <a href="ShapeDescriptor.cs.html#46b3589c7e85dda7" class="k">var</a> <span id="r7 rd" class="r7 r">descriptor</span>))
                {
                    <a href="PlacementInfo.cs.html#b3deb872be78af9d" class="k">var</a> <span id="r8 rd" class="r8 r">placement</span> = <span class="r7 r">descriptor</span>.<a href="ShapeDescriptor.cs.html#2e549b5b73b59362" class="i property">Placement</a>(<span class="r6 r">placementContext</span>);
                    <b>if</b> (<span class="r8 r">placement</span> != <b>null</b>)
                    {
                        <span class="r8 r">placement</span>.<a href="PlacementInfo.cs.html#46f313f639fea0e0" class="i property">Source</a> = <span class="r6 r">placementContext</span>.<a href="ShapeAlterationBuilder.cs.html#5be10974c2b338db" class="i property">Source</a>;
                        <b>return</b> <span class="r8 r">placement</span>;
                    }
                }
 
                <b>return</b> <b>null</b>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
