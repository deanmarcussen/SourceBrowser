<!DOCTYPE html>
<html><head><title>CommandManagerTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(61);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.Tests/Commands/CommandManagerTests.cs" target="_top">Commands\CommandManagerTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.Tests" target="_top">test\OrchardCore.Tests\OrchardCore.Tests.csproj</a> (OrchardCore.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">DependencyInjection</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">Localization</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i">Environment</span>.<span class="i">Commands</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i">Localization</span>;
<b>using</b> <span class="i">Xunit</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">Tests</span>.<span class="i n">Commands</span>
{
    <b>public class</b> <a id="7ba850000d56b16e" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">CommandManagerTests</a>
    {
        <b>private</b> <span class="i">ICommandManager</span> <a id="d702d50eafe91d7f" href="../R/d702d50eafe91d7f.html" target="n" data-glyph="46,1" class="i field">_manager</a>;
 
        <b>public</b> <a id="602336573a4aab0e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CommandManagerTests</a>()
        {
            <b>var</b> <span id="r0 rd" class="r0 r">services</span> = <b>new</b> <span class="t constructor">ServiceCollection</span>();
 
            <span class="r0 r">services</span>.<span class="i method">AddScoped</span>&lt;<span class="i">ICommandManager</span>, <span class="i">DefaultCommandManager</span>&gt;();
            <span class="r0 r">services</span>.<span class="i">AddScoped</span>&lt;<span class="i">ICommandHandler</span>, <a href="#1491a89bd24308a1" class="t t">MyCommand</a>&gt;();
            <span class="r0 r">services</span>.<span class="i method">AddSingleton</span>&lt;<span class="t t">IStringLocalizerFactory</span>, <span class="i">NullStringLocalizerFactory</span>&gt;();
            <span class="r0 r">services</span>.<span class="i method">AddTransient</span>(<b>typeof</b>(<span class="t t">IStringLocalizer</span>&lt;&gt;), <b>typeof</b>(<span class="t t">StringLocalizer</span>&lt;&gt;));
 
            <a href="#d702d50eafe91d7f" class="i field">_manager</a> = <span class="r0 r">services</span>.<span class="i method">BuildServiceProvider</span>().<span class="i method">GetService</span>&lt;<span class="i">ICommandManager</span>&gt;();
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="74669713b49f8e2f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ManagerCanRunACommand</a>()
        {
            <b>var</b> <span id="r1 rd" class="r1 r">context</span> = <b>new</b> <span class="i">CommandParameters</span> { <span class="i">Arguments</span> = <b>new</b> <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>[] { <span class="s">&quot;FooBar&quot;</span> }, <span class="i">Output</span> = <b>new</b> <a href="@1@System.Runtime/A.html#23770c70900ea7f0" class="t constructor">StringWriter</a>() };
            <a href="#d702d50eafe91d7f" class="i field">_manager</a>.<span class="i">ExecuteAsync</span>(<span class="r1 r">context</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;success!&quot;</span>, <span class="r1 r">context</span>.<span class="i">Output</span>.<span class="i">ToString</span>());
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="3efa2c2c39e9fb09" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ManagerCanRunACompositeCommand</a>()
        {
            <b>var</b> <span id="r2 rd" class="r2 r">context</span> = <b>new</b> <span class="i">CommandParameters</span> { <span class="i">Arguments</span> = (<span class="s">&quot;Foo Bar Bleah&quot;</span>).<a href="@1@System.Runtime/A.html#b06c6275ef677846" class="i method">Split</a>(<span class="s">&#39; &#39;</span>), <span class="i">Output</span> = <b>new</b> <a href="@1@System.Runtime/A.html#23770c70900ea7f0" class="t constructor">StringWriter</a>() };
            <a href="#d702d50eafe91d7f" class="i field">_manager</a>.<span class="i">ExecuteAsync</span>(<span class="r2 r">context</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Bleah&quot;</span>, <span class="r2 r">context</span>.<span class="i">Output</span>.<span class="i">ToString</span>());
        }
 
        <b>public class</b> <a id="1491a89bd24308a1" href="../R/1491a89bd24308a1.html" target="n" data-glyph="0,1" class="t t">MyCommand</a> : <span class="i">DefaultCommandHandler</span>
        {
            <b>public</b> <a id="7f8474612ea0775d" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="t constructor">MyCommand</a>() : <b>base</b>(<b>null</b>)
            {
            }
 
            <b>public string</b> <a id="36c30837c0324908" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">FooBar</a>()
            {
                <b>return</b> <span class="s">&quot;success!&quot;</span>;
            }
 
            [<span class="i">CommandName</span>(<span class="s">&quot;Foo Bar&quot;</span>)]
            <b>public string</b> <a id="8917415d4ec86f96" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Foo_Bar</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">bleah</span>)
            {
                <b>return</b> <span class="r3 r">bleah</span>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
