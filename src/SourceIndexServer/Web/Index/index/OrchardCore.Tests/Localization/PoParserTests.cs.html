<!DOCTYPE html>
<html><head><title>PoParserTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(199);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#OrchardCore.Tests/Localization/PoParserTests.cs" target="_top">Localization\PoParserTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#OrchardCore.Tests" target="_top">test\OrchardCore.Tests\OrchardCore.Tests.csproj</a> (OrchardCore.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i">Localization</span>;
<b>using</b> <span class="i n">OrchardCore</span>.<span class="i">Localization</span>.<span class="i">PortableObject</span>;
<b>using</b> <span class="i">Xunit</span>;
 
<b>namespace</b> <span class="i n">OrchardCore</span>.<span class="i n">Tests</span>.<span class="i n">Localization</span>
{
    <b>public class</b> <a id="b97d3f5e84c12342" href="../R/b97d3f5e84c12342.html" target="n" data-glyph="0,0" class="t t"><span id="cbc727c5e8c264d2">PoParserTests</span></a>
    {
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="1e5b47ec05187871" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseRetursSimpleEntry</a>()
        {
            <span class="c">// msgid &quot;Unknown system error&quot;</span>
            <span class="c">// msgstr &quot;Error desconegut del sistema&quot;</span>
            <b>var</b> <span id="r0 rd" class="r0 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;SimpleEntry&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Unknown system error&quot;</span>, <span class="r0 r">entries</span>[0].<span class="i">Key</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Error desconegut del sistema&quot;</span>, <span class="r0 r">entries</span>[0].<span class="i">Translations</span>[0]);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="29c264633576d795" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseIgnoresEntryWithoutTranslation</a>()
        {
            <span class="c">// &quot;msgid &quot;Unknown system error&quot;</span>
            <span class="c">// &quot;msgstr &quot;&quot;</span>
            <b>var</b> <span id="r1 rd" class="r1 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;EntryWithoutTranslation&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Empty</span>(<span class="r1 r">entries</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="d3ad467955d79ff4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseIgnoresPoeditHeader</a>()
        {
            <span class="c">// # Translation of kstars.po into Spanish.</span>
            <span class="c">// # This file is distributed under the same license as the kdeedu package.</span>
            <span class="c">// # Pablo de Vicente &lt;pablo@foo.com&gt;, 2005, 2006, 2007, 2008.</span>
            <span class="c">// # Eloy Cuadra &lt;eloy@bar.net&gt;, 2007, 2008.</span>
            <span class="c">// msgid &quot;&quot;</span>
            <span class="c">// msgstr &quot;&quot;</span>
            <span class="c">// &quot;Project-Id-Version: kstars\n&quot;</span>
            <span class="c">// &quot;Report-Msgid-Bugs-To: http://bugs.kde.org\n&quot;</span>
            <span class="c">// &quot;POT-Creation-Date: 2008-09-01 09:37+0200\n&quot;</span>
            <span class="c">// &quot;PO-Revision-Date: 2008-07-22 18:13+0200\n&quot;</span>
            <span class="c">// &quot;Last-Translator: Eloy Cuadra &lt;eloy@bar.net&gt;\n&quot;</span>
            <span class="c">// &quot;Language-Team: Spanish &lt;kde-l10n-es@kde.org&gt;\n&quot;</span>
            <span class="c">// &quot;MIME-Version: 1.0\n&quot;</span>
            <span class="c">// &quot;Content-Type: text/plain; charset=UTF-8\n&quot;</span>
            <span class="c">// &quot;Content-Transfer-Encoding: 8bit\n&quot;</span>
            <span class="c">// &quot;Plural-Forms: nplurals=2; plural=n != 1;\n&quot;</span>
 
            <span class="c">// msgid &quot;Unknown system error&quot;</span>
            <span class="c">// msgstr &quot;Error desconegut del sistema&quot;</span>
            <b>var</b> <span id="r2 rd" class="r2 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;PoeditHeader&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r2 r">entries</span>.<span class="i method">Count</span>() == 1);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r2 r">entries</span>[0].<span class="i">Translations</span>.<span class="i">Count</span>() == 1);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="d16800457e8773d8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseSetsContext</a>()
        {
            <span class="c">// msgctxt &quot;OrchardCore.Localization&quot;</span>
            <span class="c">// msgid &quot;Unknown system error&quot;</span>
            <span class="c">// msgstr &quot;Error desconegut del sistema&quot;</span>
            <b>var</b> <span id="r3 rd" class="r3 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;EntryWithContext&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;OrchardCore.Localization|Unknown system error&quot;</span>, <span class="r3 r">entries</span>[0].<span class="i">Key</span>, <span class="i">ignoreCase</span>: <b>true</b>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="e25c086d5648d020" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseIgnoresComments</a>()
        {
            <span class="c">// # translator-comments</span>
            <span class="c">// #. extracted-comments</span>
            <span class="c">// #: reference…</span>
            <span class="c">// #, flag</span>
 
            <span class="c">// #| msgctxt previous-context</span>
            <span class="c">// #| msgid previous-untranslated-string</span>
            <span class="c">// msgctxt &quot;OrchardCore.Localization&quot;</span>
            <span class="c">// msgid &quot;Unknown system error&quot;</span>
            <span class="c">// msgstr &quot;Error desconegut del sistema&quot;</span>
 
            <b>var</b> <span id="r4 rd" class="r4 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;EntryWithComments&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;OrchardCore.Localization|Unknown system error&quot;</span>, <span class="r4 r">entries</span>[0].<span class="i">Key</span>, <span class="i">ignoreCase</span>: <b>true</b>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Error desconegut del sistema&quot;</span>, <span class="r4 r">entries</span>[0].<span class="i">Translations</span>[0]);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="af68f3c6e59ff1e6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseOnlyTrimsLeadingAndTrailingQuotes</a>()
        {
            <span class="c">// msgid &quot;\&quot;{0}\&quot;&quot;</span>
            <span class="c">// msgstr &quot;\&quot;{0}\&quot;&quot;</span>
 
            <b>var</b> <span id="r5 rd" class="r5 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;EntryWithQuotes&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;\&quot;{0}\&quot;&quot;</span>, <span class="r5 r">entries</span>[0].<span class="i">Key</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;\&quot;{0}\&quot;&quot;</span>, <span class="r5 r">entries</span>[0].<span class="i">Translations</span>[0]);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="6165b1d3158e7050" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseHandleUnclosedQuote</a>()
        {
            <span class="c">// msgctxt &quot;</span>
            <span class="c">// msgid &quot;Foo \&quot;{0}\&quot;&quot;</span>
            <span class="c">// msgstr &quot;Foo \&quot;{0}\&quot;&quot;</span>
 
            <b>var</b> <span id="r6 rd" class="r6 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;EntryWithUnclosedQuote&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Foo \&quot;{0}\&quot;&quot;</span>, <span class="r6 r">entries</span>[0].<span class="i">Key</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="37da05b49adc5578" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseHandlesMultilineEntry</a>()
        {
            <span class="c">// msgid &quot;&quot;</span>
            <span class="c">// &quot;Here is an example of how one might continue a very long string\n&quot;</span>
            <span class="c">// &quot;for the common case the string represents multi-line output.&quot;</span>
            <span class="c">// msgstr &quot;&quot;</span>
            <span class="c">// &quot;Here is an example of how one might continue a very long translation\n&quot;</span>
            <span class="c">// &quot;for the common case the string represents multi-line output.&quot;</span>
 
            <b>var</b> <span id="r7 rd" class="r7 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;EntryWithMultilineText&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Here is an example of how one might continue a very long string\nfor the common case the string represents multi-line output.&quot;</span>, <span class="r7 r">entries</span>[0].<span class="i">Key</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Here is an example of how one might continue a very long translation\nfor the common case the string represents multi-line output.&quot;</span>, <span class="r7 r">entries</span>[0].<span class="i">Translations</span>[0]);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="a1ee64a3141404b0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParsePreservesEscapedCharacters</a>()
        {
            <span class="c">// msgid &quot;Line:\t\&quot;{0}\&quot;\n&quot;</span>
            <span class="c">// msgstr &quot;Line:\t\&quot;{0}\&quot;\n&quot;</span>
 
            <b>var</b> <span id="r8 rd" class="r8 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;EntryWithEscapedCharacters&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Line:\t\&quot;{0}\&quot;\n&quot;</span>, <span class="r8 r">entries</span>[0].<span class="i">Key</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Line:\t\&quot;{0}\&quot;\n&quot;</span>, <span class="r8 r">entries</span>[0].<span class="i">Translations</span>[0]);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="c92ffa3271f5c281" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseReadsPluralTranslations</a>()
        {
            <span class="c">// msgid &quot;book&quot;</span>
            <span class="c">// msgid_plural &quot;books&quot;</span>
            <span class="c">// msgstr[0] &quot;kniha&quot;</span>
            <span class="c">// msgstr[1] &quot;knihy&quot;</span>
            <span class="c">// msgstr[2] &quot;knih&quot;</span>
 
            <b>var</b> <span id="r9 rd" class="r9 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;EntryWithPlural&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;book&quot;</span>, <span class="r9 r">entries</span>[0].<span class="i">Key</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;kniha&quot;</span>, <span class="r9 r">entries</span>[0].<span class="i">Translations</span>[0]);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;knihy&quot;</span>, <span class="r9 r">entries</span>[0].<span class="i">Translations</span>[1]);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;knih&quot;</span>, <span class="r9 r">entries</span>[0].<span class="i">Translations</span>[2]);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="f9d40dc1324cadc7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseReadsMultipleEntries</a>()
        {
            <span class="c">// #. &quot;File {0} does not exist&quot;</span>
            <span class="c">// msgctxt &quot;OrchardCore.FileSystems.Media.FileSystemStorageProvider&quot;</span>
            <span class="c">// msgid &quot;File {0} does not exist&quot;</span>
            <span class="c">// msgstr &quot;Soubor {0} neexistuje&quot;</span>
 
            <span class="c">// #. &quot;Directory {0} does not exist&quot;</span>
            <span class="c">// msgctxt &quot;OrchardCore.FileSystems.Media.Directory&quot;</span>
            <span class="c">// msgid &quot;Directory {0} does not exist&quot;</span>
            <span class="c">// msgstr &quot;Složka {0} neexistuje&quot;</span>
 
            <b>var</b> <span id="r10 rd" class="r10 r">entries</span> = <a href="#04fe1388e3056378" class="i method">ParseText</a>(<span class="s">&quot;MultipleEntries&quot;</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(2, <span class="r10 r">entries</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;OrchardCore.FileSystems.Media.FileSystemStorageProvider|File {0} does not exist&quot;</span>, <span class="r10 r">entries</span>[0].<span class="i">Key</span>, <span class="i">ignoreCase</span>: <b>true</b>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Soubor {0} neexistuje&quot;</span>, <span class="r10 r">entries</span>[0].<span class="i">Translations</span>[0]);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;OrchardCore.FileSystems.Media.Directory|Directory {0} does not exist&quot;</span>, <span class="r10 r">entries</span>[1].<span class="i">Key</span>, <span class="i">ignoreCase</span>: <b>true</b>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Složka {0} neexistuje&quot;</span>, <span class="r10 r">entries</span>[1].<span class="i">Translations</span>[0]);
        }
 
        <b>private</b> <span class="i">CultureDictionaryRecord</span>[] <a id="04fe1388e3056378" href="../R/04fe1388e3056378.html" target="n" data-glyph="76,1" class="i method">ParseText</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r11 rd" class="r11 r">resourceName</span>)
        {
            <b>var</b> <span id="r12 rd" class="r12 r">parser</span> = <b>new</b> <span class="i">PoParser</span>();
 
            <a href="@1@System.Runtime/A.html#73b5be5e9c2474b2" class="k">var</a> <span id="r13 rd" class="r13 r">testAssembly</span> = <b>typeof</b>(<a href="#b97d3f5e84c12342" class="t t">PoParserTests</a>).<a href="@1@System.Runtime/A.html#e87d536bd07fab01" class="i property">Assembly</a>;
            <b>using</b> (<a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="k">var</a> <span id="r14 rd" class="r14 r">resource</span> = <span class="r13 r">testAssembly</span>.<a href="@1@System.Runtime/A.html#9c90fad516060e0d" class="i method">GetManifestResourceStream</a>(<span class="s">&quot;OrchardCore.Tests.Localization.PoFiles.&quot;</span> + <span class="r11 r">resourceName</span> + <span class="s">&quot;.po&quot;</span>))
            {
                <b>using</b> (<a href="@1@System.Runtime/A.html#b5fe1efcec14de32" class="k">var</a> <span id="r15 rd" class="r15 r">reader</span> = <b>new</b> <a href="@1@System.Runtime/A.html#72447927169f6b77" class="t constructor">StreamReader</a>(<span class="r14 r">resource</span>))
                {
                    <b>return</b> <span class="r12 r">parser</span>.<span class="i">Parse</span>(<span class="r15 r">reader</span>).<span class="i">ToArray</span>();
                }
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
